# Тест-кейсы для валидации конфигурационного файла

## ⚠️ Важно
В требованиях к параметру Locale указано, что значение должно соответствовать формату, определённому в RFC 3066, однако в примере приведено значение в формате POSIX (en_US.UTF-8), которое отличается от стандарта RFC 3066 (например, en-US).

Для корректной валидации я подготовила два варианта регулярных выражений:

```

pattern = r'^[a-zA-Z]{2,3}(?:-[a-zA-Z]{2})?$' # **RFC 3066**

pattern = r"^[a-zA-Z]{2,3}(?:_[a-zA-Z]{2})?(?:\.[a-zA-Z0-9-]+)?$"  # **POSIX**
```
В данный момент тесты используют строку для POSIX-формата, чтобы соответствовать приведённому примеру.
Если требуется использовать именно формат RFC 3066, пожалуйста, раскомментируйте соответствующую строку (27) в файле  `tests/test_config_validation.py`.



## 1. Проверки структуры файла
| ID  | Название                     | Описание                          | Ожидаемый результат        |
|-----|------------------------------|-----------------------------------|-----------------------------|
| 1.1 | Отсутствие обязательных секций | Конфиг без секции `General` или `Watchdog` | Ошибка валидации          |
| 1.2 | Наличие неизвестных секций    | Конфиг с секцией `UnknownSection` | Ошибка валидации          |
| 1.3 | Пустые секции                | Секция без параметров             | Ошибка валидации          |
| 1.4 | Дублирование секций          | Две секции `[General]`            | Ошибка валидации          |
| 1.5 | Дублирование параметров      | Два параметра `ScanMemoryLimit`   | Ошибка валидации          |
| 1.6 | Параметры вне секций         | Ключ=значение до первой секции    | Ошибка валидации          |

## 2. Проверки параметров секции `General`
| ID  | Название                     | Описание                          | Ожидаемый результат        |
|-----|------------------------------|-----------------------------------|-----------------------------|
| 2.1 | `ScanMemoryLimit` (1024-8192)| Значение 1023                     | Ошибка валидации          |
| 2.2 | `ScanMemoryLimit` (1024-8192)| Значение 8193                     | Ошибка валидации          |
| 2.3 | `PackageType` (rpm/deb)      | Значение RPM (верхний регистр)    | Допустимо (регистр не важен) |
| 2.4 | `PackageType` (rpm/deb)      | Значение apt                      | Ошибка валидации          |
| 2.5 | `CoreDumpsPath` (путь)       | Несуществующий путь               | Ошибка валидации          |
| 2.6 | `MachineId` (UUID)           | UUID без дефисов                  | Ошибка валидации          |
| 2.7 | `Locale` (RFC 3066/POSIX)    | `en_US.UTF-8`                     | Допустимо (в соответствии с примером) |
| 2.8 | `Locale` (RFC 3066/POSIX)    | `en-US`                           | Ошибка (если требуется POSIX) |

## 3. Проверки параметров секции `Watchdog`
| ID  | Название                     | Описание                          | Ожидаемый результат        |
|-----|------------------------------|-----------------------------------|-----------------------------|
| 3.1 | `ConnectTimeout` (1-120m)    | `121m`                            | Ошибка валидации          |
| 3.2 | `ConnectTimeout` (1-120m)    | `50` (без 'm')                    | Ошибка валидации          |
| 3.3 | `MaxVirtualMemory` (auto/off/число)| `auto` (нижний регистр)      | Допустимо                 |
| 3.4 | `MaxVirtualMemory` (auto/off/число)| `AUTO` (верхний регистр)      | Допустимо (регистр не важен) |
| 3.5 | `MaxMemory` (число)          | `100.001`                         | Ошибка (превышение диапазона) |
| 3.6 | `PingInterval` (100-10000)   | `99`                              | Ошибка валидации          |

## 4. Специальные кейсы
| ID  | Название                     | Описание                          | Ожидаемый результат        |
|-----|------------------------------|-----------------------------------|-----------------------------|
| 4.1 | Пустой файл                  | Конфиг без содержимого            | Ошибка валидации          |
| 4.2 | Комментарии                  | Строки, начинающиеся с `;` или `#` | Игнорируются              |
| 4.3 | Регистр параметров           | `scanmemorylimit` вместо `ScanMemoryLimit` | Ошибка валидации          |
| 4.4 | Пробелы вокруг `=`           | `Key = Value`                     | Допустимо (пробелы тримятся) |

## 5. Граничные значения
| ID  | Параметр              | Тестируемое значение | Ожидаемый результат |
|-----|-----------------------|----------------------|---------------------|
| 5.1 | `ScanMemoryLimit`     | 1024                 | Допустимо           |
| 5.2 | `ScanMemoryLimit`     | 8192                 | Допустимо           |
| 5.3 | `MaxInotifyWatches`   | 1000                 | Допустимо           |
| 5.4 | `MaxInotifyWatches`   | 1000000              | Допустимо           |
| 5.5 | `PingInterval`        | 100                  | Допустимо           |
| 5.6 | `PingInterval`        | 10000                | Допустимо           |
